!function(e){function t(e){return plupload.translate(e)||e}function i(i,n){n.contents().each(function(t,i){i=e(i),i.is(".plupload")||i.remove()}),n.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+i+'_container" class="plupload_container">'+'<div class="plupload">'+'<div class="plupload_header">'+'<div class="plupload_header_content">'+'<div class="plupload_header_title">'+t("Select files")+"</div>"+'<div class="plupload_header_text">'+t("Add files to the upload queue and click the start button.")+"</div>"+"</div>"+"</div>"+'<div class="plupload_content">'+'<div class="plupload_filelist_header">'+'<div class="plupload_file_name">'+t("Filename")+"</div>"+'<div class="plupload_file_action">&nbsp;</div>'+'<div class="plupload_file_status"><span>'+t("Status")+"</span></div>"+'<div class="plupload_file_size">'+t("Size")+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+"</div>"+'<ul id="'+i+'_filelist" class="plupload_filelist"></ul>'+'<div class="plupload_filelist_footer">'+'<div class="plupload_file_name">'+'<div class="plupload_buttons">'+'<a href="#" class="plupload_button plupload_add" id="'+i+'_browse">'+t("Add Files")+"</a>"+'<a href="#" class="plupload_button plupload_start">'+t("Start Upload")+"</a>"+"</div>"+'<span class="plupload_upload_status"></span>'+"</div>"+'<div class="plupload_file_action"></div>'+'<div class="plupload_file_status"><span class="plupload_total_status">0%</span></div>'+'<div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div>'+'<div class="plupload_progress">'+'<div class="plupload_progress_container">'+'<div class="plupload_progress_bar"></div>'+"</div>"+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+"</div>"+"</div>"+"</div>"+"</div>"+'<input type="hidden" id="'+i+'_count" name="'+i+'_count" value="0" />'+"</div>")}var n={};e.fn.pluploadQueue=function(r){return r?(this.each(function(){function o(t){var i;t.status==plupload.DONE&&(i="plupload_done"),t.status==plupload.FAILED&&(i="plupload_failed"),t.status==plupload.QUEUED&&(i="plupload_delete"),t.status==plupload.UPLOADING&&(i="plupload_uploading");var n=e("#"+t.id).attr("class",i).find("a").css("display","block");t.hint&&n.attr("title",t.hint)}function s(){e("span.plupload_total_status",c).html(u.total.percent+"%"),e("div.plupload_progress_bar",c).css("width",u.total.percent+"%"),e("span.plupload_upload_status",c).html(plupload.sprintf(t("Uploaded %d/%d files"),u.total.uploaded,u.files.length))}function a(){var i,n=e("ul.plupload_filelist",c).html(""),r=0;e.each(u.files,function(t,s){i="",s.status==plupload.DONE&&(s.target_name&&(i+='<input type="hidden" name="'+d+"_"+r+'_tmpname" value="'+plupload.xmlEncode(s.target_name)+'" />'),i+='<input type="hidden" name="'+d+"_"+r+'_name" value="'+plupload.xmlEncode(s.name)+'" />',i+='<input type="hidden" name="'+d+"_"+r+'_status" value="'+(s.status==plupload.DONE?"done":"failed")+'" />',r++,e("#"+d+"_count").val(r)),n.append('<li id="'+s.id+'">'+'<div class="plupload_file_name"><span>'+s.name+"</span></div>"+'<div class="plupload_file_action"><a href="#"></a></div>'+'<div class="plupload_file_status">'+s.percent+"%</div>"+'<div class="plupload_file_size">'+plupload.formatSize(s.size)+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+i+"</li>"),o(s),e("#"+s.id+".plupload_delete a").click(function(t){e("#"+s.id).remove(),u.removeFile(s),t.preventDefault()})}),e("span.plupload_total_file_size",c).html(plupload.formatSize(u.total.size)),0===u.total.queued?e("span.plupload_add_text",c).html(t("Add Files")):e("span.plupload_add_text",c).html(plupload.sprintf(t("%d files queued"),u.total.queued)),e("a.plupload_start",c).toggleClass("plupload_disabled",u.files.length==u.total.uploaded+u.total.failed),n[0].scrollTop=n[0].scrollHeight,s(),!u.files.length&&u.features.dragdrop&&u.settings.dragdrop&&e("#"+d+"_filelist").append('<li class="plupload_droptext">'+t("Drag files here.")+"</li>")}function l(){delete n[d],u.destroy(),c.html(p),u=c=p=null}var u,c,d,p;c=e(this),d=c.attr("id"),d||(d=plupload.guid(),c.attr("id",d)),p=c.html(),i(d,c),r=e.extend({dragdrop:!0,browse_button:d+"_browse",container:d},r),r.dragdrop&&(r.drop_element=d+"_filelist"),u=new plupload.Uploader(r),n[d]=u,u.bind("UploadFile",function(t,i){e("#"+i.id).addClass("plupload_current_file")}),u.bind("Init",function(t,i){!r.unique_names&&r.rename&&c.on("click","#"+d+"_filelist div.plupload_file_name span",function(i){var n,r,o,s=e(i.target),a="";n=t.getFile(s.parents("li")[0].id),o=n.name,r=/^(.+)(\.[^.]+)$/.exec(o),r&&(o=r[1],a=r[2]),s.hide().after('<input type="text" />'),s.next().val(o).focus().blur(function(){s.show().next().remove()}).keydown(function(t){var i=e(this);13==t.keyCode&&(t.preventDefault(),n.name=i.val()+a,s.html(n.name),i.blur())})}),e("#"+d+"_container").attr("title","Using runtime: "+i.runtime),e("a.plupload_start",c).click(function(t){e(this).hasClass("plupload_disabled")||u.start(),t.preventDefault()}),e("a.plupload_stop",c).click(function(e){e.preventDefault(),u.stop()}),e("a.plupload_start",c).addClass("plupload_disabled")}),u.bind("Error",function(i,n){var r,o=n.file;o&&(r=n.message,n.details&&(r+=" ("+n.details+")"),n.code==plupload.FILE_SIZE_ERROR&&alert(t("Error: File too large:")+" "+o.name),n.code==plupload.FILE_EXTENSION_ERROR&&alert(t("Error: Invalid file extension:")+" "+o.name),o.hint=r,e("#"+o.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",r)),n.code===plupload.INIT_ERROR&&setTimeout(function(){l()},1)}),u.bind("PostInit",function(i){i.settings.dragdrop&&i.features.dragdrop&&e("#"+d+"_filelist").append('<li class="plupload_droptext">'+t("Drag files here.")+"</li>")}),u.init(),u.bind("StateChanged",function(){u.state===plupload.STARTED?(e("li.plupload_delete a,div.plupload_buttons",c).hide(),u.disableBrowse(!0),e("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",c).css("display","block"),e("span.plupload_upload_status",c).html("Uploaded "+u.total.uploaded+"/"+u.files.length+" files"),r.multiple_queues&&e("span.plupload_total_status,span.plupload_total_file_size",c).show()):(a(),e("a.plupload_stop,div.plupload_progress",c).hide(),e("a.plupload_delete",c).css("display","block"),r.multiple_queues&&u.total.uploaded+u.total.failed==u.files.length&&(e(".plupload_buttons,.plupload_upload_status",c).css("display","inline"),u.disableBrowse(!1),e(".plupload_start",c).addClass("plupload_disabled"),e("span.plupload_total_status,span.plupload_total_file_size",c).hide()))}),u.bind("FilesAdded",a),u.bind("FilesRemoved",function(){var t=e("#"+d+"_filelist").scrollTop();a(),e("#"+d+"_filelist").scrollTop(t)}),u.bind("FileUploaded",function(e,t){o(t)}),u.bind("UploadProgress",function(t,i){e("#"+i.id+" div.plupload_file_status",c).html(i.percent+"%"),o(i),s()}),r.setup&&r.setup(u)}),this):n[e(this[0]).attr("id")]}}(jQuery);